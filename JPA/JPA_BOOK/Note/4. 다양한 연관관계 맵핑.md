## 다대일(N:1) 양방향

- 양방향은 외래키가 있는 쪽이 **연관관계의 주인**이다. 

  - 연관관계의 주인이 아닌쪽은 조회만 가능.

- 양방향 연관관계는 항상 서로를 참조해야된다.

  - 항상 서로를 참조하게하려면 **연관관계 편의 메소드**를 작성하는게 좋은데 양쪽 다 연관관계편의 메소드를 작성할 경우, 무한루프에 빠질 수 있으므로 주의해야한다. **또한, 무한루프에 빠지지않게 하기위해 검사하는 로직도 있다.**

  

## 일대다(1:N) 단방향

- **일대다 단방향 관계를 맵핑할때는 꼭 @JoinColumn**을 명시해야됨.
  -> @JoinColumn으로 맵핑을 안할 경우, 두테이블 중간에 연관관계를 관리하는 조인테이블전략을 기본으로 사용하여 맵핑함.

## 일대일 (1:1)

- **일대일 관계는 주 테이블, 대상 테이블 상관없이 아무곳이나 외래키를 갖고있으면 된다.**
  대신 둘중 한개의 테이블은 무조건 외래키를 갖고 있어야한다. 
  -> 갖고있는 엔티티가 연관관계의 주인

## 다대다(N:N)

- RDBMS는 정규화된 테이블 2개로 다대다 관계를 표현할 수 없다.
- **다대다 관계는 주테이블과 대상테이블 사이에 연결 테이블을 추가해야한다.**
- 연결 테이블에서 서로의 기본키값 외에 추가적인 컬럼이 필요할땐 복합 기본키를 사용하여 
  다대다 관계를 맺는다. 

### 복합키를 위한 식별자 클래스 특징

- 복합 키는 별도의 식별자 클래스가 필요

  ```java
  @Entity
  @IdClass(MemberProductId.class)
  @NoArgsConstructor
  public class MemberProduct {
  		....
  		....
  }
  ```

- Serializable을 구현해야함.

- equals와 hashcode 메소드를 구현해야함.

  - @IdClass 사용 외에 @EmbeddedId를 통한 방법도 있음.

**다대다 관계를 일대다 다대일 관계로 풀어내기 위해서는 식별자를 어떻게 구성해야될지 선택해야 한다.**

식별자 구성 방법

- 식별 관계 : 받아온 식별자를 기본 키 + 외래키로 사용.
- 비식별 관계 : 받아온 식별자는 외래키로 사용하고 새로운 식별자 사용. 
  **-> JPA와 같은 ORM 사용시 , 추천.**